<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC
"-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="zh-TW">
  <head>
    <title>Input test</title>
    <script>
        var input;
        var output;
        var compositionStart = false;

        function composition_start(event) {
          //start input Chinese, set 'compositionStart' flag true
          console.log('composition_start');
          compositionStart = true;
        }

        function composition_end(event) {
          //stop input Chinese, set 'compositionStart' flag false
          console.log('composition_end');
          if(compositionStart) {
            setTimeout(function(){
              var text = event.target.value;
              if(text) {
                output.innerHTML+=('you type: ' + text + '\n'); //show text in output
              }
              event.target.value='';
              compositionStart = false;
            }, 0);
          }
        }

        function text_input(event) {
          console.log('text_input');
          if(!compositionStart) {
            event.stopPropagation();
            event.preventDefault();
            var text = event.target.value;
            if(text) {
              output.innerHTML+=('you type: ' + text + '\n'); //show text in output
            }
            event.target.value='';
          }
        }

        function startup() {
            input = document.getElementById('input');
            output = document.getElementById('output');

            input.addEventListener('compositionstart', composition_start, false);
            input.addEventListener('compositionend', composition_end, false);
            input.addEventListener('input', text_input, true);
        }
        window.addEventListener('load', startup, true);

    </script>
  </head>
  <body>
	  <pre>
	  This issue is for Forefox 41 windows platform.
	  Test step:
	  (1) Type Chinese in Input, you can select word. It will show in Output after you finish typing.
	  (2) Type Chinese in Input again, you can't' select word.<BR>
	  </pre>
      Input <input id='input' style='width:500px'/><BR><BR>
      Output <pre id='output'></pre>
  </body>
</html>