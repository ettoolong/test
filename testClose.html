<!DOCTYPE html>
<html>
<head>
<title>test beforeunload</title>
<script>
window.addEventListener('beforeunload', function(event){
    console.log('test');
    event.returnValue = true;
    return document.title;
}, false);

function load() {
var event = document.createEvent('KeyboardEvent'); // create a key event
// define the event
event.initKeyEvent("keypress",       // typeArg,
                   true,             // canBubbleArg,
                   true,             // cancelableArg,
                   null,             // viewArg,  Specifies UIEvent.view. This value may be null.
                   false,            // ctrlKeyArg,
                   false,            // altKeyArg,
                   false,            // shiftKeyArg,
                   false,            // metaKeyArg,
                    0,               // keyCodeArg,
                    8);              // charCodeArg);

document.getElementById('test').dispatchEvent(event);

// document.getElementById('test').addEventListener('keypress', function(event){
//     console.log(event);
// });

}

window.addEventListener('load', load, true);

</script>
</head>
<body>
<pre>
<input id="test"/>
window.addEventListener('beforeunload', function(event){
    console.log('test');
    event.returnValue = true;
    return document.title;
}, false);
</pre>
</body>
</html>